args.legend = list(x=20,y=40,cex=0.5,horiz=TRUE,text.col="darkgreen"))
text(migrafica, partidosXX + 0.1 , partidosXX, cex=0.6,pos=3)
par = old.par
#1) Cargar dataframe
datos = read.csv("futbolNEW.csv",header=TRUE)
str(datos)
#2) Añadir tres partidos a la lista
añadidos = data.frame(Casa=c(10,11,10),Visitante=c(0,8,9))
datos=rbind(datos,añadidos)
#3) Cálculo del nuevo vector QUINIELAS
datos$Quiniela = (datos$Casa>datos$Visitante)*1+(datos$Casa<datos$Visitante)*2
datos$Quiniela = as.factor(datos$Quiniela)
levels(datos$Quiniela) = c("X","1","2")
View(datos)
#4) tabla frecuencias absolutas ftable, con Quiniela en columnas
t1 = ftable(datos,col.vars = c("Quiniela"))
t1
#5) Tabla de frecuencias absolutas de partidos empatados
cat("\014")
empatados = datos[datos$Quiniela=="X",]
t2 = apply(table(empatados), MARGIN = 1,FUN=sum)
#5) Tabla de frecuencias absolutas de partidos empatados
cat("\014")
empatados = datos[datos$Quiniela=="X",]
t2 = apply(table(empatados), MARGIN = 1,FUN=sum)
#reduzco y quito la información de quinielas, y como la de Casa y
# visitante es la misma en este caso, me quedo solo con la variación CASA
t2
empatados
table(empatados)
#7) partidos que ganaron los visitantes 0 - ...
visitantes = datos[datos$Quiniela=="2",]
table(visitantes)
t3 = apply(table(visitantes),MARGIN=c(1,2),FUN=sum)
t3
t3["0",]
t3 = apply(table(visitantes),MARGIN=1,FUN=sum)
t3
# Ejercicio 9. Problema Fútbol
# =============================
futbol = read.csv("futbol.csv",header=TRUE)
# Ejercicio 9. Problema Fútbol
# =============================
futbol = read.csv("futbol.csv",header=TRUE)
# Añado los partidos
futbol = rbind(futbol,data.frame(Casa=c(10,11,10),Visitante=c(0,8,9)))
tail(futbol)
# Frecuencias absoluta y relativa
t1 = table(futbol$Casa,futbol$Visitante)
t2 = 100*prop.table(t1)
t1
t2
# Resultados que nunca se han producido
# Convierto la tabla de frecuencias relativas en dataframe
resultados=data.frame(t1)
resultados[resultados$Freq==0,]
n=dim(resultados[resultados$Freq==0,])[1]
n
# Resultado más frecuente
resultados[which(resultados$Freq==max(resultados$Freq)),]
t1
apply(t1,MARGIN=2,FUN=sum)
apply(t1,MARGIN=1,FUN=sum)
t4 = t(apply(prop.table(t1),MARGIN=1,FUN=sum)) #obtiene la suma total. Mostrar t(t4)
t4
t4["0"]
t4["0",]
t4[0,]
t4[1,"0"]
# Ejercicio 10. Múltiple valores
# =============================
futbol = read.csv("futbolNEW.csv",header=TRUE)
# Añado los partidos
futbol = rbind(futbol,data.frame(Casa=c(10,11,10),Visitante=c(0,8,9)))
tail(futbol)
# Añado la columna QUNIELA
cat("\014")
futbol$Quiniela = ((futbol$Casa-futbol$Visitante)>0)*1+((futbol$Casa-futbol$Visitante)<0)*2
futbol$Quiniela = as.factor(futbol$Quiniela)
levels(futbol$Quiniela)=c("X","1","2")
head(futbol,10)
str(futbol)
# Frecuencias absoluta y relativa
t1=table(futbol)
t2= ftable(futbol,col.vars=c("Quiniela"))
t2
# Encuentra la tabla de frecuencias de los partidos empatados
cat("\014")
empatados = futbol[futbol$Quiniela=="X",]
t3=ftable(empatados$Casa)
t3
sum(t3)
# o bien
t4 = apply(table(empatados),MARGIN=c(1,3),FUN=sum)
t4
t4 = apply(table(empatados),MARGIN=c(1),FUN=sum)
t4
cumsum(t4)
# o bien
t4 = apply(table(empatados),MARGIN=c(1,3),FUN=sum)
t4
cumsum(t4)
# Gráfica de los partidos cuyo resultado es  0 - X, según los goles de los visitantes
partidos0X = table(futbol[futbol$Casa==0 & futbol$Visitante>0,2])
colores=topo.colors(length(partidos0X))
old.par=par()
par=(mar=c(0,0,0,0))
migrafica = barplot(partidos0X,main="Nº partidos 0-X ",beside=TRUE,xlab="X",ylab="Nº partidos",
horiz=FALSE,col=colores, ylim=c(0,max(partidos0X)+20),
legend.text =names(partidos0X),
args.legend = list(x=20,y=40,cex=0.5,horiz=TRUE,text.col="darkgreen"))
text(migrafica, partidos0X + 0.1 , partidos0X, cex=0.6,pos=3)
par = old.par
t4
t4[,"X"]
partidosXX = t4[,"X"]
colores=topo.colors(length(partidosXX))
old.par=par()
par=(mar=c(0,0,0,0))
migrafica = barplot(partidosXX,main="Nº partidos X-X ",beside=TRUE,xlab="X",ylab="Nº partidos",
horiz=FALSE,col=colores, ylim=c(0,max(partidosXX)+20),
legend.text =names(t4),
args.legend = list(x=20,y=40,cex=0.5,horiz=TRUE,text.col="darkgreen"))
text(migrafica, partidosXX + 0.1 , partidosXX, cex=0.6,pos=3)
par = old.par
# Ejercicio 9. Problema Fútbol
# =============================
futbol = read.csv("futbolNEW.csv",header=TRUE)
# Añado los partidos
futbol = rbind(futbol,data.frame(Casa=c(10,11,10),Visitante=c(0,8,9)))
tail(futbol)
# Añado la columna QUNIELA
cat("\014")
futbol$Quiniela = ((futbol$Casa-futbol$Visitante)>0)*1+((futbol$Casa-futbol$Visitante)<0)*2
futbol$Quiniela = as.factor(futbol$Quiniela)
levels(futbol$Quiniela)=c("X","1","2")
head(futbol,10)
str(futbol)
# Añado el average
futbol$Average = (futbol$Casa>futbol$Visitante)*(futbol$Casa-futbol$Visitante)
# Diferencia si han ganado los de casa, y cero en caso contrario
View(futbol)
liga = futbol[,c(3,4)]
# Ordenar los factores
liga$Quiniela = ordered(liga$Quiniela,levels=c("1","X","2"))
liga$Average = ordered(liga$Average)
cat("\014")
str(liga)
t1=table(liga)
t1
t1ACU = t(apply(t1,MARGIN=1,FUN=cumsum))
t1ACU
t1ACU = t(apply(t1,MARGIN=2,FUN=cumsum))
t1ACU
t1ACU = t(apply(t1,MARGIN=1,FUN=cumsum))
t1ACU
t1ACU = t(apply(t1,MARGIN=1,FUN=sum))
t1ACU
t1=table(liga)
t1ACU = t(apply(t1,MARGIN=1,FUN=cumsum))
t1ACU
sum(t1["1",]) # otra forma de verlo
t2=prop.table(table(liga))*100
t2
t2ACU=t(apply(round(t2,2),MARGIN=1,FUN=cumsum))
t2ACU
t2=prop.table(table(liga))*100
t2
# Obtener la tabla de frecuencias relativas ACUMULADAS del data frame liga.
# ¿Qué es más probable, que el equipo gane o pierda?
t2ACU=t(apply(round(t2,2),MARGIN=1,FUN=cumsum))
t2ACU
sprintf("Es más probable que gane por un margen del %.2f%%",t2ACU["1","10"]-t2ACU["2","10"] )
sprintf("Es más probable que pierda por un margen del %.2f%%",
t2ACU["2","10"]-t2ACU["1","3"] )
barplot(t1ACU,beside=TRUE, legend.text = levels(unique(liga$Quiniela))
,col=topo.colors(length(unique(liga$Quiniela)))
,args.legend=list(y=1500,x=10,cex=0.55,ncol=2)
,ylim=c(0,max(t1ACU)+200))
barplot(t1ACU["1",],beside=TRUE, legend.text = levels(unique(liga$Quiniela))
,col=topo.colors(length(unique(liga$Quiniela)))
,args.legend=list(y=1500,x=10,cex=0.55,ncol=2)
,ylim=c(0,max(t1ACU)+200))
#1) Cargar dataframe
datos = read.csv("futbolNEW.csv",header=TRUE)
str(datos)
#1) Cargar dataframe
datos = read.csv("futbolNEW.csv",header=TRUE)
str(datos)
#2) Añadir tres partidos a la lista
añadidos = data.frame(Casa=c(10,11,10),Visitante=c(0,8,9))
datos=rbind(datos,añadidos)
str(datos)
dim(datos)[1]
tail(datos)
#2a) tabla de frecuencias absolutas y relativas
t1 = table(datos)
t2 = 100*prop.table(t1)
t1
t2
ftable(t1)
round(t2,2)
#2b) Resultados que no se han producido
resultados = data.frame(t1)
resultados=resultados[resultados$Freq==0,]
resultados
dim(resultados)[1]
#2c) Resultado de más frecuencia
resultados[resultados$Freq==max(resultados$Freq),]
#2c) Resultado de más frecuencia
resultados = data.frame(t1)
resultados[resultados$Freq==max(resultados$Freq),]
#2a) tabla de frecuencias absolutas y relativas (EJERCICIO 9)
t1 = table(datos)
t2 = 100*prop.table(t1)
#2b) Resultados que no se han producido
resultados = data.frame(t1)
resultados=resultados[resultados$Freq==0,]
resultados
#2c) Resultado de más frecuencia
resultados = data.frame(t1)
resultados[resultados$Freq==max(resultados$Freq),]
#2d) ¿Con qué frecuencia relativa (porcentaje) se da los partidos en los que el equipo de casa no marca un gol?
t3 = apply(t2,MARGIN=1,FUN=sum)
t3
#2d) ¿Con qué frecuencia relativa (porcentaje) se da los partidos en los que el equipo de casa no marca un gol?
t3 = apply(t2,MARGIN=1,FUN=sum)
t3=round(t3,2)
t3
t3["0"]
#2e) ¿Con qué frecuencia relativa (porcentaje) se da los partidos en los que el equipo visitante no marca un gol? Usa la función sum o cumsum, el método apply y MARGIN adecuado.
t4 = apply(t2,MARGIN=2,FUN=sum)
t4=round(t4,2)
t4
t4["0"]
#1) Cargar dataframe
datos = read.csv("futbolNEW.csv",header=TRUE)
str(datos)
#2) Añadir tres partidos a la lista
añadidos = data.frame(Casa=c(10,11,10),Visitante=c(0,8,9))
datos=rbind(datos,añadidos)
#2a) tabla de frecuencias absolutas y relativas (EJERCICIO 9)
t1 = table(datos)
t2 = 100*prop.table(t1)
#2b) Resultados que no se han producido
resultados = data.frame(t1)
resultados=resultados[resultados$Freq==0,]
resultados
#2c) Resultado de más frecuencia
resultados = data.frame(t1)
resultados[resultados$Freq==max(resultados$Freq),]
#2d) ¿Con qué frecuencia relativa (porcentaje) se da los partidos en los que el equipo de casa no marca un gol?
t3 = apply(t2,MARGIN=1,FUN=sum)
t3=round(t3,2)
#2e) ¿Con qué frecuencia relativa (porcentaje) se da los partidos en los que el equipo visitante no marca un gol? Usa la función sum o cumsum, el método apply y MARGIN adecuado.
t4 = apply(t2,MARGIN=2,FUN=sum)
t4=round(t4,2)
#2f) Gráfica de los partidos 0-X
# Gráfica de los partidos cuyo resultado es  0 - X, según los goles de los visitantes
partidos0X = t1["0",]
colores=topo.colors(length(partidos0X))
old.par=par()
par=(mar=c(0,0,0,0))
migrafica = barplot(partidos0X,main="Nº partidos 0-X ",beside=TRUE,xlab="X",ylab="Nº partidos",
horiz=FALSE,col=colores, ylim=c(0,max(partidos0X)+20),
legend.text =names(t1["0",]),
args.legend = list(x=20,y=40,cex=0.5,horiz=TRUE,text.col="darkgreen"))
text(migrafica, partidos0X + 0.1 , partidos0X, cex=0.6,pos=3)
par = old.par
partidos0X
#1) Cargar dataframe
datos = read.csv("futbolNEW.csv",header=TRUE)
str(datos)
#2) Añadir tres partidos a la lista
añadidos = data.frame(Casa=c(10,11,10),Visitante=c(0,8,9))
datos=rbind(datos,añadidos)
datos$Quiniela = (datos$Casa>datos$Visitante)*1+(datos$Casa<datos$Visitante)*2
datos$Quiniela = as.factor(datos$Quiniela)
levels(datos$Quiniela) = c("X","1","2")
tail(datos)
#4) tabla frecuencias absolutas ftable, con Quiniela en columnas
t1 = ftable(datos,col.vars = c("Quiniela"))
t1
#4) tabla frecuencias absolutas ftable, con Quiniela en columnas
t1 = ftable(datos,col.vars = c("Quiniela"))
tail(t1)
t1
#1) Cargar dataframe
datos = read.csv("futbolNEW.csv",header=TRUE)
str(datos)
#2) Añadir tres partidos a la lista
añadidos = data.frame(Casa=c(10,11,10),Visitante=c(0,8,9))
datos=rbind(datos,añadidos)
# #2a) tabla de frecuencias absolutas y relativas (EJERCICIO 9)
# t1 = table(datos)
# t2 = 100*prop.table(t1)
#
# #2b) Resultados que no se han producido
# resultados = data.frame(t1)
# resultados=resultados[resultados$Freq==0,]
# resultados
#
# #2c) Resultado de más frecuencia
# resultados = data.frame(t1)
# resultados[resultados$Freq==max(resultados$Freq),]
#
# #2d) ¿Con qué frecuencia relativa (porcentaje) se da los partidos en los que el equipo de casa no marca un gol?
# t3 = apply(t2,MARGIN=1,FUN=sum)
# t3=round(t3,2)
#
# #2e) ¿Con qué frecuencia relativa (porcentaje) se da los partidos en los que el equipo visitante no marca un gol? Usa la función sum o cumsum, el método apply y MARGIN adecuado.
# t4 = apply(t2,MARGIN=2,FUN=sum)
# t4=round(t4,2)
#
# #2f) Gráfica de los partidos 0-X
# # Gráfica de los partidos cuyo resultado es  0 - X, según los goles de los visitantes
# partidos0X = t1["0",]
# colores=topo.colors(length(partidos0X))
# old.par=par()
# par=(mar=c(0,0,0,0))
# migrafica = barplot(partidos0X,main="Nº partidos 0-X ",beside=TRUE,xlab="X",ylab="Nº partidos",
#                     horiz=FALSE,col=colores, ylim=c(0,max(partidos0X)+20),
#                     legend.text =names(t1["0",]),
#                     args.legend = list(x=20,y=40,cex=0.5,horiz=TRUE,text.col="darkgreen"))
# text(migrafica, partidos0X + 0.1 , partidos0X, cex=0.6,pos=3)
# par = old.par
#3) Cálculo del nuevo vector QUINIELAS
datos$Quiniela = (datos$Casa>datos$Visitante)*1+(datos$Casa<datos$Visitante)*2
datos$Quiniela = as.factor(datos$Quiniela)
levels(datos$Quiniela) = c("X","1","2")
# datos$Quiniela=ordered(datos$Quiniela,levels=c("1","X","2"))
#4) tabla frecuencias absolutas ftable, con Quiniela en columnas
t1 = ftable(datos,col.vars = c("Quiniela"))
t1
#5) Tabla de frecuencias absolutas de partidos empatados
cat("\014")
empatados = datos[datos$Quiniela=="X",]
t2 = apply(table(empatados), MARGIN = 1,FUN=sum)
t2
table(empatados)
t2
#1) Cargar dataframe
datos = read.csv("futbolNEW.csv",header=TRUE)
str(datos)
#2) Añadir tres partidos a la lista
añadidos = data.frame(Casa=c(10,11,10),Visitante=c(0,8,9))
datos=rbind(datos,añadidos)
# #2a) tabla de frecuencias absolutas y relativas (EJERCICIO 9)
# t1 = table(datos)
# t2 = 100*prop.table(t1)
#
# #2b) Resultados que no se han producido
# resultados = data.frame(t1)
# resultados=resultados[resultados$Freq==0,]
# resultados
#
# #2c) Resultado de más frecuencia
# resultados = data.frame(t1)
# resultados[resultados$Freq==max(resultados$Freq),]
#
# #2d) ¿Con qué frecuencia relativa (porcentaje) se da los partidos en los que el equipo de casa no marca un gol?
# t3 = apply(t2,MARGIN=1,FUN=sum)
# t3=round(t3,2)
#
# #2e) ¿Con qué frecuencia relativa (porcentaje) se da los partidos en los que el equipo visitante no marca un gol? Usa la función sum o cumsum, el método apply y MARGIN adecuado.
# t4 = apply(t2,MARGIN=2,FUN=sum)
# t4=round(t4,2)
#
# #2f) Gráfica de los partidos 0-X
# # Gráfica de los partidos cuyo resultado es  0 - X, según los goles de los visitantes
# partidos0X = t1["0",]
# colores=topo.colors(length(partidos0X))
# old.par=par()
# par=(mar=c(0,0,0,0))
# migrafica = barplot(partidos0X,main="Nº partidos 0-X ",beside=TRUE,xlab="X",ylab="Nº partidos",
#                     horiz=FALSE,col=colores, ylim=c(0,max(partidos0X)+20),
#                     legend.text =names(t1["0",]),
#                     args.legend = list(x=20,y=40,cex=0.5,horiz=TRUE,text.col="darkgreen"))
# text(migrafica, partidos0X + 0.1 , partidos0X, cex=0.6,pos=3)
# par = old.par
#3) Cálculo del nuevo vector QUINIELAS
datos$Quiniela = (datos$Casa>datos$Visitante)*1+(datos$Casa<datos$Visitante)*2
datos$Quiniela = as.factor(datos$Quiniela)
levels(datos$Quiniela) = c("X","1","2")
# datos$Quiniela=ordered(datos$Quiniela,levels=c("1","X","2"))
#4) tabla frecuencias absolutas ftable, con Quiniela en columnas
t1 = ftable(datos,col.vars = c("Quiniela"))
t1
#5) Tabla de frecuencias absolutas de partidos empatados
cat("\014")
empatados = datos[datos$Quiniela=="X",]
t2 = table(empatados)
t3 = apply(t2, MARGIN = 1,FUN=sum)
#reduzco y quito la información de quinielas, y como la de Casa y
# visitante es la misma en este caso, me quedo solo con la variación CASA
t3
#6) partidos empatados en total
sum(t3)
#1) Cargar dataframe
datos = read.csv("futbolNEW.csv",header=TRUE)
str(datos)
#2) Añadir tres partidos a la lista
añadidos = data.frame(Casa=c(10,11,10),Visitante=c(0,8,9))
datos=rbind(datos,añadidos)
# #2a) tabla de frecuencias absolutas y relativas (EJERCICIO 9)
# t1 = table(datos)
# t2 = 100*prop.table(t1)
#
# #2b) Resultados que no se han producido
# resultados = data.frame(t1)
# resultados=resultados[resultados$Freq==0,]
# resultados
#
# #2c) Resultado de más frecuencia
# resultados = data.frame(t1)
# resultados[resultados$Freq==max(resultados$Freq),]
#
# #2d) ¿Con qué frecuencia relativa (porcentaje) se da los partidos en los que el equipo de casa no marca un gol?
# t3 = apply(t2,MARGIN=1,FUN=sum)
# t3=round(t3,2)
#
# #2e) ¿Con qué frecuencia relativa (porcentaje) se da los partidos en los que el equipo visitante no marca un gol? Usa la función sum o cumsum, el método apply y MARGIN adecuado.
# t4 = apply(t2,MARGIN=2,FUN=sum)
# t4=round(t4,2)
#
# #2f) Gráfica de los partidos 0-X
# # Gráfica de los partidos cuyo resultado es  0 - X, según los goles de los visitantes
# partidos0X = t1["0",]
# colores=topo.colors(length(partidos0X))
# old.par=par()
# par=(mar=c(0,0,0,0))
# migrafica = barplot(partidos0X,main="Nº partidos 0-X ",beside=TRUE,xlab="X",ylab="Nº partidos",
#                     horiz=FALSE,col=colores, ylim=c(0,max(partidos0X)+20),
#                     legend.text =names(t1["0",]),
#                     args.legend = list(x=20,y=40,cex=0.5,horiz=TRUE,text.col="darkgreen"))
# text(migrafica, partidos0X + 0.1 , partidos0X, cex=0.6,pos=3)
# par = old.par
#3) Cálculo del nuevo vector QUINIELAS
datos$Quiniela = (datos$Casa>datos$Visitante)*1+(datos$Casa<datos$Visitante)*2
datos$Quiniela = as.factor(datos$Quiniela)
levels(datos$Quiniela) = c("X","1","2")
# datos$Quiniela=ordered(datos$Quiniela,levels=c("1","X","2"))
#4) tabla frecuencias absolutas ftable, con Quiniela en columnas
t1 = ftable(datos,col.vars = c("Quiniela"))
t1
#5) Tabla de frecuencias absolutas de partidos empatados
cat("\014")
empatados = datos[datos$Quiniela=="X",]
t2 = table(empatados)
t3 = apply(t2, MARGIN = 1,FUN=sum)
#reduzco y quito la información de quinielas, y como la de Casa y
# visitante es la misma en este caso, me quedo solo con la variación CASA
t3
#6) partidos empatados en total
sum(t3)
t2 = t3
#7) partidos que ganaron los visitantes 0 - ...
visitantes = datos[datos$Quiniela=="2",]
t3 = apply(table(visitantes),MARGIN=c(1,2),FUN=sum)
t4 =t3["0",]
cat("\014")
#8) gráfica
colores = terrain.colors(length(t2))
leyenda = paste0("0-",names(t2))
old.par=par()
par=(mar=c(0,0,0,0))
b1 = barplot (t2,main="Nº partidos X-X ",beside=TRUE,xlab="X",ylab="Nº partidos",
horiz=FALSE,col=colores, ylim=c(0,max(t4)+20),
legend.text =leyenda,
args.legend = list(x=8,y=105,cex=0.7,horiz=TRUE,text.col="darkgreen"))
text(b1,t2+2,t2,cex=0.9,pos=3)
par = old.par
#9) gráfica
colores = topo.colors(length(t4))
leyenda = paste0("0-",names(t4))
old.par=par()
par=(mar=c(0,0,0,0))
b1 = barplot (t4,main="Nº partidos 0-X ",beside=TRUE,xlab="X",ylab="Nº partidos",
horiz=FALSE,col=colores, ylim=c(0,max(t4)+20),
legend.text =leyenda,
args.legend = list(x=8,y=105,cex=0.7,horiz=TRUE,text.col="darkgreen"))
text(b1,t4+2,t4,cex=0.9,pos=3)
par = old.par
#5) Tabla de frecuencias absolutas de partidos empatados
cat("\014")
empatados = datos[datos$Quiniela=="X",]
t2 = table(empatados)
t3 = apply(t2, MARGIN = 1,FUN=sum)
#reduzco y quito la información de quinielas, y como la de Casa y
# visitante es la misma en este caso, me quedo solo con la variación CASA
t3
#6) partidos empatados en total
sum(t3)
t2 = t3
t2
visitantes = datos[datos$Quiniela=="2",]
t3 = apply(table(visitantes),MARGIN=c(1,2),FUN=sum)
t4 =t3["0",]
t3
table(visitantes)
t3
t4
colores = topo.colors(length(t4))
leyenda = paste0("0-",names(t4))
old.par=par()
par=(mar=c(0,0,0,0))
b1 = barplot (t4,main="Nº partidos 0-X ",beside=TRUE,xlab="X",ylab="Nº partidos",
horiz=FALSE,col=colores, ylim=c(0,max(t4)+20),
legend.text =leyenda,
args.legend = list(x=8,y=105,cex=0.7,horiz=TRUE,text.col="darkgreen"))
text(b1,t4+2,t4,cex=0.9,pos=3)
par = old.par
